"use strict";(self.webpackChunkthiagola_92_github_io=self.webpackChunkthiagola_92_github_io||[]).push([[6971],{24491:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>d,toc:()=>c});var o=i(85893),a=i(11151);const r={authors:"thiagola92",tags:["c","c++","libs","lib","windows"]},s="C/C++ Libs (Win)",d={permalink:"/en/blog/2024/04/01/c-cpp-lib-win",editUrl:"https://github.com/thiagola92/thiagola92.github.io/tree/master/blog/2024-04-01-c-cpp-lib-win/index.md",source:"@site/blog/2024-04-01-c-cpp-lib-win/index.md",title:"C/C++ Libs (Win)",description:"Durante o post C/C++ Libs escrevi sobre usar bibliotecas no Linux e nunca imaginaria que teria novamente a dor de cabe\xe7a de ver o assunto quando fosse fazer o mesmo no Windows.",date:"2024-04-01T00:00:00.000Z",formattedDate:"April 1, 2024",tags:[{label:"c",permalink:"/en/blog/tags/c"},{label:"libs",permalink:"/en/blog/tags/libs"},{label:"lib",permalink:"/en/blog/tags/lib"},{label:"windows",permalink:"/en/blog/tags/windows"}],hasTruncateMarker:!1,authors:[{name:"Thiago Lages de Alencar",title:"Desenvolvedor de Software",url:"https://github.com/thiagola92",imageURL:"/img/dino.svg",key:"thiagola92"}],frontMatter:{authors:"thiagola92",tags:["c","c++","libs","lib","windows"]},unlisted:!1,prevItem:{title:"TTY, Terminal, Shell, CLI, TUI, GUI",permalink:"/en/blog/2024/04/20/tty-terminal-shell-cli-tui-gui"},nextItem:{title:"Inverse Kinematics: FABR",permalink:"/en/blog/2024/03/29/ik-fabr"}},l={authorsImageUrls:[void 0]},c=[{value:"<code>.lib</code> (library)",id:"lib-library",level:2},{value:"<code>.dll</code> (dynamic-link library)",id:"dll-dynamic-link-library",level:2},{value:"Project from Zero",id:"project-from-zero",level:2},{value:"<code>.lib</code>",id:"lib",level:3},{value:"<code>.dll</code>",id:"dll",level:3}];function t(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Durante o post ",(0,o.jsx)(n.a,{href:"/en/blog/2024/02/12/c-cpp-lib",children:"C/C++ Libs"})," escrevi sobre usar bibliotecas no Linux e nunca imaginaria que teria novamente a dor de cabe\xe7a de ver o assunto quando fosse fazer o mesmo no Windows."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Personagem do desenho The Owl House chorando",src:i(35271).Z+"",width:"400",height:"400"})}),"\n",(0,o.jsxs)(n.admonition,{type:"warning",children:[(0,o.jsxs)(n.p,{children:["Importante avisar que eu irei escrever este post contando que voc\xea leu o ",(0,o.jsx)(n.a,{href:"/en/blog/2024/02/12/c-cpp-lib",children:"post passado"})," sobre Linux."]}),(0,o.jsx)(n.p,{children:"Irei ser breve e n\xe3o irei estudar detalhes que nem fiz no do linux (pois estou cansado do assunto)."})]}),"\n",(0,o.jsxs)(n.h2,{id:"lib-library",children:[(0,o.jsx)(n.code,{children:".lib"})," (library)"]}),"\n",(0,o.jsxs)(n.p,{children:["Basicamente id\xeantico ao ",(0,o.jsx)(n.code,{children:".a"})," do Linux, uma biblioteca est\xe1tica (",(0,o.jsx)(n.strong,{children:"static library"}),")."]}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsx)(n.p,{children:"Descobri que estes arquivos podem ser abertos tranquilamente com programas de zip tipo: Winrar, 7zip, PeaZip."}),(0,o.jsxs)(n.p,{children:['O que faz total sentido dado que eles programas para lidar com "File archive and extractor" e no Linux usando o formato ',(0,o.jsx)(n.code,{children:".a"}),' de "archive".']})]}),"\n",(0,o.jsxs)(n.h2,{id:"dll-dynamic-link-library",children:[(0,o.jsx)(n.code,{children:".dll"})," (dynamic-link library)"]}),"\n",(0,o.jsxs)(n.p,{children:["Seria o pr\xf3ximo do ",(0,o.jsx)(n.code,{children:".so"})," do Linux, servindo o mesmo prop\xf3sito de uma biblioteca compartilhada (",(0,o.jsx)(n.strong,{children:"shared library"}),") por\xe9m o Windows possui uma implementa\xe7\xe3o pr\xf3pria deles (",(0,o.jsx)(n.strong,{children:"dynamic-link library"}),")."]}),"\n",(0,o.jsxs)(n.p,{children:["A grande diferen\xe7a que precisamos saber \xe9 que durante a cria\xe7\xe3o de bibliotecas compartilhadas, tr\xeas formatos de arquivos s\xe3o criados: ",(0,o.jsx)(n.code,{children:".dll"}),", ",(0,o.jsx)(n.code,{children:".lib"})," e ",(0,o.jsx)(n.code,{children:".exp"})," (vamos ignorar este \xfaltimo)."]}),"\n",(0,o.jsxs)(n.p,{children:["Onde o arquivo ",(0,o.jsx)(n.code,{children:".lib"})," ",(0,o.jsx)(n.strong,{children:"N\xc3O"})," \xe9 o mesmo que o gerado durante a biblioteca est\xe1tica! Por\xe9m ainda \xe9 necess\xe1rio para a utiliza\xe7\xe3o da biblioteca compartilhada."]}),"\n",(0,o.jsx)(n.h2,{id:"project-from-zero",children:"Project from Zero"}),"\n",(0,o.jsx)(n.p,{children:"Seguiremos a mesma ideia do post no Linux. Apenas tendo o nosso c\xf3digo:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"project/\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 main.c\n    \u2514\u2500\u2500 ...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cl src\\main.c\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"Agora com um header:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"project/\n\u251c\u2500\u2500 include/\n\u2502   \u2514\u2500\u2500 header.h\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 main.c\n    \u2514\u2500\u2500 ...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cl src/main.c /Iinclude\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"lib",children:(0,o.jsx)(n.code,{children:".lib"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"project/\n\u251c\u2500\u2500 include/\n\u2502   \u2514\u2500\u2500 header.h\n\u251c\u2500\u2500 lib/\n\u2502   \u2514\u2500\u2500 name.lib\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 main.c\n    \u2514\u2500\u2500 ...\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cl src/main.c /Iinclude lib/name.lib\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["Windows n\xe3o tem o padr\xe3o de botar ",(0,o.jsx)(n.code,{children:"lib"})," na frente das bibliotecas ent\xe3o n\xe3o precisa nem pensar nisso."]})}),"\n",(0,o.jsx)(n.h3,{id:"dll",children:(0,o.jsx)(n.code,{children:".dll"})}),"\n",(0,o.jsxs)(n.p,{children:["Dessa vez vamos separar em duas etapas: compilar o c\xf3digo para ",(0,o.jsx)(n.code,{children:".obj"})," e depois linkar (gerar o ",(0,o.jsx)(n.code,{children:".exe"}),"), isso torna mais f\xe1cil adicionar explica\xe7\xf5es no meio."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"project/\n\u251c\u2500\u2500 include/\n\u2502   \u2514\u2500\u2500 header.h\n\u251c\u2500\u2500 lib/\n\u2502   \u2514\u2500\u2500 name.lib\n\u2514\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.c\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500  name.dll\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Lembre que bibliotecas din\xe2micas no Windows utilizam um arquivo ",(0,o.jsx)(n.code,{children:".dll"})," e um ",(0,o.jsx)(n.code,{children:".lib"})," (por isso temos os dois no projeto).",(0,o.jsx)(n.br,{}),"\n","Windows busca os arquivos ",(0,o.jsx)(n.code,{children:".dll"})," na mesma pasta do execut\xe1vel, por isso ele n\xe3o est\xe1 na pasta lib."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cl src/main.c /c /Iinclude /Dexample\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"/c"})," \xe9 justamente para pausar antes de linkar.",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.code,{children:"/Dexample"})," \xe9 uma maneira de adicionar uma defini\xe7\xe3o no in\xedcio do c\xf3digo, equivalente a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-C",children:"#define example\n"})}),"\n",(0,o.jsx)(n.p,{children:"Por que precisamos definir? Em bibliotecas do Windows, muitas vezes pode se encontrar c\xf3digo como o seguinte:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-C",children:"#if defined(EXPORT_DLL)\n    #define LIB_API __declspec(dllexport)\n#elif defined(IMPORT_DLL)\n    #define LIB_API __declspec(dllimport)\n#else\n    #define LIB_API\n#endif\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Onde ",(0,o.jsx)(n.code,{children:"LIB_API"})," \xe9 substituido por:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"__declspec(dllexport)"})," quando criando uma biblioteca din\xe2nmica"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"__declspec(dllimport)"})," quando importando uma biblioteca din\xe2mica"]}),"\n",(0,o.jsx)(n.li,{children:"nada quando \xe9 uma biblioteca est\xe1tica"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"N\xe3o entendo bem do assunto ent\xe3o n\xe3o pretendo entrar no assunto, mas \xe9 a maneira do windows lidar com bibliotecas din\xe2micas."}),"\n",(0,o.jsxs)(n.p,{children:["Biblitoecas geralmente requerem que voc\xea passe essa defini\xe7\xe3o para que ela adicione o contexto certo ao c\xf3digo durante a cria\xe7\xe3o do objeto (para fazer ",(0,o.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Name_mangling",children:"name mangling"})," corretamente?)."]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"link /LIBPATH:lib name.lib main.obj\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\xc9 durante a etapa de linkar que o arquivo ",(0,o.jsx)(n.code,{children:".lib"})," \xe9 finalmente utilizado!"]}),"\n",(0,o.jsxs)(n.p,{children:["Lembrando novamente que o execut\xe1vel vai buscar o ",(0,o.jsx)(n.code,{children:".dll"})," na pasta do execut\xe1vel, ent\xe3o bote ambos juntos."]})]})}function m(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},35271:(e,n,i)=>{i.d(n,{Z:()=>o});const o=i.p+"assets/images/hooty_crying-7d12f678da8b0332716cd7d055f691d1.svg"},11151:(e,n,i)=>{i.d(n,{Z:()=>d,a:()=>s});var o=i(67294);const a={},r=o.createContext(a);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);