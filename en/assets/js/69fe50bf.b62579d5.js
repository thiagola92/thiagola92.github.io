"use strict";(self.webpackChunkthiagola_92_github_io=self.webpackChunkthiagola_92_github_io||[]).push([[2850],{70323:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>d,toc:()=>t});var o=n(85893),a=n(11151);const i={authors:"thiagola92",tags:["go","error"]},s="Elegantly Handling Error in Go",d={permalink:"/en/blog/2026/02/24/go-error-handling",editUrl:"https://github.com/thiagola92/thiagola92.github.io/tree/master/blog/2026-02-24-go-error-handling/index.md",source:"@site/blog/2026-02-24-go-error-handling/index.md",title:"Elegantly Handling Error in Go",description:"Eu tenho meses de experi\xeancia em Go ent\xe3o \xe9 bem idiota da minha parte dar minha opni\xe3o sobre uma linguage que n\xe3o utilizo muito.",date:"2026-02-24T00:00:00.000Z",formattedDate:"February 24, 2026",tags:[{label:"go",permalink:"/en/blog/tags/go"},{label:"error",permalink:"/en/blog/tags/error"}],hasTruncateMarker:!1,authors:[{name:"Thiago Lages de Alencar",title:"Desenvolvedor de Software",url:"https://github.com/thiagola92",imageURL:"/img/dino.svg",key:"thiagola92"}],frontMatter:{authors:"thiagola92",tags:["go","error"]},unlisted:!1,nextItem:{title:"HTML importing HTML",permalink:"/en/blog/2025/12/10/html-import-html"}},c={authorsImageUrls:[void 0]},t=[{value:"Return the Error",id:"return-the-error",level:2},{value:"Handling Error",id:"handling-error",level:2},{value:"There&#39;s a Catch",id:"theres-a-catch",level:2},{value:"<code>panic()</code> &amp; <code>recover()</code>",id:"panic--recover",level:2},{value:"Elegant Logic Flow",id:"elegant-logic-flow",level:2}];function l(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.admonition,{type:"danger",children:[(0,o.jsx)(r.p,{children:"Eu tenho meses de experi\xeancia em Go ent\xe3o \xe9 bem idiota da minha parte dar minha opni\xe3o sobre uma linguage que n\xe3o utilizo muito."}),(0,o.jsxs)(r.p,{children:["Sem contar que error handling \xe9 um assunto ",(0,o.jsx)(r.strong,{children:"muito"})," sens\xedvel dentro da comunidade de Go, pessoas odeiam e pessoas amam."]}),(0,o.jsx)(r.p,{children:"Ent\xe3o este post vai servir como reflex\xe3o para mim."})]}),"\n",(0,o.jsx)(r.h2,{id:"return-the-error",children:"Return the Error"}),"\n",(0,o.jsx)(r.p,{children:'Parte de mim adora a simplicidade de "se sua fun\xe7\xe3o pode falhar, retorne o error".'}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() error {\n    // ...\n    return err\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"E j\xe1 que Go permite retorna multiplos resultados, n\xe3o existe perda de clareza."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() (int, error) {\n    // ...\n    return number, err\n}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"handling-error",children:"Handling Error"}),"\n",(0,o.jsx)(r.p,{children:"Se a linguagem escolheu pelo design de retorna o error, quer dizer que a fun\xe7\xe3o que chamou precisa verificar erro."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doYYY() error {\n    value, err := doXXX()\n\n    if err != nil {\n        return err\n    }\n\n    // ...\n\n    return nil\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"Por quest\xe3o de simplicidade, neste exemplo estou apenas repassando o erro."}),"\n",(0,o.jsx)(r.p,{children:"Dito isto, fica para cada um decidir o que vai fazer quando encontrar um erro. Por exemplo:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Escrever no log"}),"\n",(0,o.jsx)(r.li,{children:"Adicionar mais informa\xe7\xf5es ao erro"}),"\n",(0,o.jsx)(r.li,{children:"Omitir detalhes do erro"}),"\n",(0,o.jsx)(r.li,{children:"Repassar o erro"}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"Todos eles s\xe3o v\xe1lidos! A situa\xe7\xe3o que voc\xea se encontra \xe9 o que dita o melhor para se usar."}),"\n",(0,o.jsx)(r.h2,{id:"theres-a-catch",children:"There's a Catch"}),"\n",(0,o.jsx)(r.p,{children:"Muitas pessoas gostam disto pois for\xe7a a lidar com o erro, em vez de ficar repassando o erro at\xe9 alguma fun\xe7\xe3o decidir tratar."}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.a,{href:"https://go.dev/doc/faq#exceptions",children:"https://go.dev/doc/faq#exceptions"})}),"\n",(0,o.jsx)(r.p,{children:"Enquanto os argumentos s\xe3o v\xe1lidos, eu acho que Go falha em apontar uma alternativa elegante. Pois se cria um ambiente que incentiva a seguinte estrutura:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() error {\n    err := doAAA()\n\n    if err != nil {\n        return err\n    }\n\n    err = doBBB()\n\n    if err != nil {\n        return err\n    }\n\n    err = doCCC()\n\n    if err != nil {\n        return err\n    }\n\n    err = doDDD()\n\n    if err != nil {\n        return err\n    }\n\n    // ...\n\n    return nil\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"Programadores normalmente seguem regras de no m\xe1ximo X caracteres por linha. Go me faz desejar que existisse uma regra de X linhas por fun\xe7\xe3o..."}),"\n",(0,o.jsx)(r.p,{children:"Essa estrutura ocorre muito mais do que se imagina!"}),"\n",(0,o.jsx)(r.p,{children:"As pessoas esquecem que as fun\xe7\xf5es mais b\xe1sicas de programa\xe7\xe3o (como abrir arquivo) podem falhar. O que vai causar uma rea\xe7\xe3o em cadeia em sua fun\xe7\xf5es."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"A() \ud83d\udfe2\n\u2514\u2500\u2500 B() \ud83d\udfe0\n    \u2514\u2500\u2500 C() \ud83d\udfe0\n        \u2514\u2500\u2500 D() \ud83d\udfe0\n            \u2514\u2500\u2500 F() \ud83d\udd34\n"})}),"\n",(0,o.jsx)(r.p,{children:"Agora todas as fun\xe7\xf5es acima de F() teram o c\xf3digo:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"if err != nil {\n    return err\n}\n"})}),"\n",(0,o.jsxs)(r.p,{children:["A solu\xe7\xe3o mais b\xe1sica \xe9 tratar o mais cedo poss\xedvel (em ",(0,o.jsx)(r.code,{children:"D()"}),") mas isso s\xf3 \xe9 poss\xedvel quando voc\xea possue a solu\xe7\xe3o do problema."]}),"\n",(0,o.jsxs)(r.p,{children:["Imagina se enquanto o usu\xe1rio est\xe1 baixando um jogo na ",(0,o.jsx)(r.a,{href:"https://en.wikipedia.org/wiki/Steam_(service)",children:"Steam"})," acaba o espa\xe7o no HD. A Steam precisa se comunicar com o usu\xe1rio sobre o problema e ela n\xe3o pode tomar a decis\xe3o de como abrir espa\xe7o."]}),"\n",(0,o.jsx)(r.p,{children:'\xc9 a situa\xe7\xe3o que voc\xea quer pausar a linha de racioc\xednio principal e borbulhar o erro para cima, at\xe9 chegar no usu\xe1rio. Olha que engra\xe7ado, parece at\xe9 que existe uma raz\xe3o por inventarem "try-catch"...'}),"\n",(0,o.jsxs)(r.h2,{id:"panic--recover",children:[(0,o.jsx)(r.code,{children:"panic()"})," & ",(0,o.jsx)(r.code,{children:"recover()"})]}),"\n",(0,o.jsxs)(r.p,{children:["A necessidade de borbulhar o erro para cima \xe9 t\xe3o grande que Go possui dois m\xe9todos para isto ",(0,o.jsx)(r.code,{children:"panic()"})," e ",(0,o.jsx)(r.code,{children:"recover()"}),"."]}),"\n",(0,o.jsxs)(r.p,{children:["Agora se estivermos em ",(0,o.jsx)(r.code,{children:"F()"})," e iniciarmos um estado de panic, podemos solucionar em ",(0,o.jsx)(r.code,{children:"A()"}),"."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:'func F() {\n    // ...\n\n    if problem {\n        panic(errors.New("Problem in F"))\n    }\n\n    // ...\n}\n'})}),"\n",(0,o.jsxs)(r.p,{children:["Justamente pelo fato de que qualquer fun\xe7\xe3o chamada com ",(0,o.jsx)(r.code,{children:"defer"}),", ir\xe1 ser executada independente de como a fun\xe7\xe3o terminar (normalmente ou em estado de panic)."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func A() {\n    defer solvePanic()\n\n    // ...\n\n    B()\n\n    // ...\n}\n"})}),"\n",(0,o.jsxs)(r.p,{children:["E podemos sair do estado de panic e coletar o erro utilizando ",(0,o.jsx)(r.code,{children:"recover()"}),"."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func solvePanic() {\n    if err := recover(); err != nil {\n        // ...\n    }\n}\n"})}),"\n",(0,o.jsxs)(r.p,{children:['Seguindo essa l\xf3gica podemos reduzir drasticamente o n\xfamero de "if-error" entre ',(0,o.jsx)(r.code,{children:"A()"})," e ",(0,o.jsx)(r.code,{children:"F()"}),"."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"A() \ud83d\udfe2\n\u2514\u2500\u2500 B() \ud83d\udfe2\n    \u2514\u2500\u2500 C() \ud83d\udfe2\n        \u2514\u2500\u2500 D() \ud83d\udfe2\n            \u2514\u2500\u2500 F() \ud83d\udd34\n"})}),"\n",(0,o.jsxs)(r.admonition,{type:"info",children:[(0,o.jsx)(r.p,{children:"Isto da ao tratamento de erro uma certa eleg\xe2ncia comparado ao try-catch, pois a ramifica\xe7\xe3o fica na mesma fun\xe7\xe3o:"}),(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() {\n    try {\n        // Default logic\n    } catch XXX {\n        // Execute on error\n    }\n}\n"})}),(0,o.jsx)(r.p,{children:"Enquanto Go incentiva a deixar em outra fun\xe7\xe3o:"}),(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() {\n    defer solveXXX()\n    // Default logic\n}\n\nfunc solveXXX() {\n    // Execute on error\n}\n"})})]}),"\n",(0,o.jsx)(r.h2,{id:"elegant-logic-flow",children:"Elegant Logic Flow"}),"\n",(0,o.jsx)(r.p,{children:'Ainda possuimos o problema em que uma fun\xe7\xe3o pode crescer verticalmente com diversas ocorr\xeancias de "if-error".'}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() error {\n    err := doAAA()\n\n    if err != nil {\n        return err\n    }\n\n    err = doBBB()\n\n    if err != nil {\n        return err\n    }\n\n    err = doCCC()\n\n    if err != nil {\n        return err\n    }\n\n    err = doDDD()\n\n    if err != nil {\n        return err\n    }\n\n    // ...\n\n    return nil\n}\n"})}),"\n",(0,o.jsxs)(r.p,{children:["Podemos utilizar a mesma l\xf3gica da se\xe7\xe3o acima para criar uma fun\xe7\xe3o que causa ",(0,o.jsx)(r.code,{children:"panic()"})," quando um erro \xe9 encontrado:"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func assertNoErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc doXXX() error {\n    assertNoErr(doAAA())\n    assertNoErr(doBBB())\n    assertNoErr(doCCC())\n    assertNoErr(doDDD())\n\n    // ...\n\n    return nil\n}\n"})}),"\n",(0,o.jsx)(r.p,{children:"Na minha opni\xe3o, isto j\xe1 melhora bastante a leitura."}),"\n",(0,o.jsxs)(r.p,{children:["Por\xe9m est\xe1 fun\xe7\xe3o est\xe1 causando um ",(0,o.jsx)(r.code,{children:"panic()"})," e pode n\xe3o ser o que a gente queira para ela. Como podemos continuar elegantes e retornar um erro normal? Utilizando ",(0,o.jsx)(r.a,{href:"https://go.dev/tour/basics/7",children:(0,o.jsx)(r.strong,{children:"named return"})}),"."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func doXXX() (err error) {\n    // ...\n}\n"})}),"\n",(0,o.jsxs)(r.p,{children:["Agora ",(0,o.jsx)(r.code,{children:"err"})," vai ser a vari\xe1vel retornada pela fun\xe7\xe3o quando ela encerrar (e n\xe3o estiver em estado de panic)."]}),"\n",(0,o.jsxs)(r.p,{children:["Tudo que falta \xe9 garantir que vamos sair do estado de panic e que ",(0,o.jsx)(r.code,{children:"err"})," possua o valor do \xfaltimo error."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-go",children:"func catchErr(err *error) {\n    if r := recover(); r != nil {\n        *err = r.(error)\n    }\n}\n\nfunc assertNoErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc doXXX() (err error) {\n    defer catchErr(&err)\n\n    assertNoErr(doAAA())\n    assertNoErr(doBBB())\n    assertNoErr(doCCC())\n    assertNoErr(doDDD())\n\n    // ...\n\n    return nil\n}\n"})}),"\n",(0,o.jsx)(r.h1,{id:"references",children:"References"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/blog/defer-panic-and-recover",children:"https://go.dev/blog/defer-panic-and-recover"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/blog/error-handling-and-go",children:"https://go.dev/blog/error-handling-and-go"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/blog/error-syntax",children:"https://go.dev/blog/error-syntax"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/doc/effective_go#errors",children:"https://go.dev/doc/effective_go#errors"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/doc/faq#exceptions",children:"https://go.dev/doc/faq#exceptions"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://go.dev/tour/basics/7",children:"https://go.dev/tour/basics/7"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://www.reddit.com/r/golang/comments/1in0tiw/simple_strategy_to_understand_error_handling_in_go/",children:"https://www.reddit.com/r/golang/comments/1in0tiw/simple_strategy_to_understand_error_handling_in_go/"})}),"\n",(0,o.jsx)(r.li,{children:(0,o.jsx)(r.a,{href:"https://en.wikipedia.org/wiki/Exception_handling_(programming)",children:"https://en.wikipedia.org/wiki/Exception_handling_(programming)"})}),"\n"]})]})}function u(e={}){const{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},11151:(e,r,n)=>{n.d(r,{Z:()=>d,a:()=>s});var o=n(67294);const a={},i=o.createContext(a);function s(e){const r=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:r},e.children)}}}]);